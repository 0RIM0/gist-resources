(function(){"use strict";var n=typeof n<"u"?n:{},v={},m;for(m in n)n.hasOwnProperty(m)&&(v[m]=n[m]);var h=n.printErr||console.warn.bind(console);for(m in v)v.hasOwnProperty(m)&&(n[m]=v[m]);var D=(e,t)=>{throw t};v=null,n.arguments&&n.arguments,n.thisProgram&&(thisProgram=n.thisProgram),n.quit&&(D=n.quit),typeof WebAssembly!="object"&&b("no native wasm support detected");var S,x=!1,R,A;function Z(){var e=S.buffer;n.HEAP8=new Int8Array(e),n.HEAPU8=A=new Uint8Array(e)}var C=[],I=[],M=[];function B(){if(n.preRun)for(typeof n.preRun=="function"&&(n.preRun=[n.preRun]);n.preRun.length;)K(n.preRun.shift());E(C)}function J(){E(I)}function V(){if(n.postRun)for(typeof n.postRun=="function"&&(n.postRun=[n.postRun]);n.postRun.length;)X(n.postRun.shift());E(M)}function K(e){C.unshift(e)}function Q(e){I.unshift(e)}function X(e){M.unshift(e)}var _=0,y=null;function Y(e){var t;_++,(t=n.monitorRunDependencies)===null||t===void 0||t.call(n,_)}function G(e){var t;if(_--,(t=n.monitorRunDependencies)===null||t===void 0||t.call(n,_),_==0&&y){var r=y;y=null,r()}}function b(e){var t;(t=n.onAbort)===null||t===void 0||t.call(n,e),e="Aborted("+e+")",h(e),x=!0,e+=". Build with -sASSERTIONS for more info.";var r=new WebAssembly.RuntimeError(e);throw r}function q(){return{a:me}}function ee(e){return fetch(e,{credentials:"same-origin"}).then(function(t){if(!t.ok)throw"failed to load wasm binary file at '"+e+"'";return t.arrayBuffer()})}function te(e){var t=q();function r(o,f){return l=o.exports,S=l.f,Z(),Q(l.g),G(),l}Y();function i(o){r(o.instance)}function c(o){return ee(e).then(function(f){var d=WebAssembly.instantiate(f,t);return d}).then(o,function(f){h("failed to asynchronously prepare wasm: "+f),b(f)})}function a(){return e&&e.byteLength>0?WebAssembly.instantiate(e,t).then(i,function(o){h("wasm compile failed: "+o)}):typeof WebAssembly.instantiateStreaming=="function"&&typeof e=="string"&&typeof fetch=="function"?fetch(e,{credentials:"same-origin"}).then(function(o){var f=WebAssembly.instantiateStreaming(o,t);return f.then(i,function(d){return h("wasm streaming compile failed: "+d),h("falling back to ArrayBuffer instantiation"),c(i)})}):c(i)}if(n.instantiateWasm)try{var s=n.instantiateWasm(t,r);return s}catch(o){return h("Module.instantiateWasm callback failed with error: "+o),!1}return a(),{}}class z{constructor(t){this.name="ExitStatus",this.message=`Program terminated with exit(${t})`,this.status=t}}var E=e=>{for(;e.length>0;)e.shift()(n)},L=n.noExitRuntime||!0,ne=()=>b(""),U=0,re=()=>{L=!1,U=0},g={},W=e=>{if(e instanceof z||e=="unwind")return R;D(1,e)},P=()=>L||U>0,k=e=>{var t;R=e,P()||((t=n.onExit)===null||t===void 0||t.call(n,e),x=!0),D(e,new z(e))},ie=(e,t)=>{R=e,k(e)},ae=ie,oe=()=>{if(!P())try{ae(R)}catch(e){W(e)}},se=e=>{if(!x)try{e(),oe()}catch(t){W(t)}},ce=()=>performance.now(),ue=(e,t)=>{if(g[e]&&(clearTimeout(g[e].id),delete g[e]),!t)return 0;var r=setTimeout(()=>{delete g[e],se(()=>$(e,ce()))},t);return g[e]={id:r,timeout_ms:t},0},le=()=>2147483648,fe=(e,t)=>Math.ceil(e/t)*t,de=e=>{var t=S.buffer,r=(e-t.byteLength+65535)/65536|0;try{return S.grow(r),Z(),1}catch{}},pe=e=>{var t=A.length;e>>>=0;var r=le();if(e>r)return!1;for(var i=1;i<=4;i*=2){var c=t*(1+.2/i);c=Math.min(c,e+100663296);var a=Math.min(r,fe(Math.max(e,c),65536)),s=de(a);if(s)return!0}return!1},me={c:ne,b:re,d:ue,e:pe,a:k},l;n._ZSTD_isError=e=>(n._ZSTD_isError=l.h)(e),n._ZSTD_compressBound=e=>(n._ZSTD_compressBound=l.i)(e),n._ZSTD_createCCtx=()=>(n._ZSTD_createCCtx=l.j)(),n._ZSTD_freeCCtx=e=>(n._ZSTD_freeCCtx=l.k)(e),n._ZSTD_compress_usingDict=(e,t,r,i,c,a,s,o)=>(n._ZSTD_compress_usingDict=l.l)(e,t,r,i,c,a,s,o),n._ZSTD_compress=(e,t,r,i,c)=>(n._ZSTD_compress=l.m)(e,t,r,i,c),n._ZSTD_createDCtx=()=>(n._ZSTD_createDCtx=l.n)(),n._ZSTD_freeDCtx=e=>(n._ZSTD_freeDCtx=l.o)(e),n._ZSTD_getFrameContentSize=(e,t)=>(n._ZSTD_getFrameContentSize=l.p)(e,t),n._ZSTD_decompress_usingDict=(e,t,r,i,c,a,s)=>(n._ZSTD_decompress_usingDict=l.q)(e,t,r,i,c,a,s),n._ZSTD_decompress=(e,t,r,i)=>(n._ZSTD_decompress=l.r)(e,t,r,i),n._malloc=e=>(n._malloc=l.s)(e),n._free=e=>(n._free=l.t)(e);var $=(e,t)=>($=l.v)(e,t),T;y=function e(){T||N(),T||(y=e)};function N(){if(_>0||(B(),_>0))return;function e(){var t;T||(T=!0,n.calledRun=!0,!x&&(J(),(t=n.onRuntimeInitialized)===null||t===void 0||t.call(n),V()))}n.setStatus?(n.setStatus("Running..."),setTimeout(()=>{setTimeout(()=>n.setStatus(""),1),e()},1)):e()}if(n.run=N,n.preInit)for(typeof n.preInit=="function"&&(n.preInit=[n.preInit]);n.preInit.length>0;)n.preInit.pop()();n.init=te;var _e=function(e,t,r,i){function c(a){return a instanceof r?a:new r(function(s){s(a)})}return new(r||(r=Promise))(function(a,s){function o(u){try{d(i.next(u))}catch(p){s(p)}}function f(u){try{d(i.throw(u))}catch(p){s(p)}}function d(u){u.done?a(u.value):c(u.value).then(o,f)}d((i=i.apply(e,t||[])).next())})};const he=new Promise(e=>{n.onRuntimeInitialized=e}),ve=()=>_e(void 0,void 0,void 0,function*(){yield he}),ye=e=>{const t=n._ZSTD_isError;return t(e)},ge=(e,t)=>{const r=n._ZSTD_getFrameContentSize;return r(e,t)},we=(e,t={defaultHeapSize:1024*1024})=>{const r=n._malloc,i=r(e.byteLength);n.HEAP8.set(e,i);const c=ge(i,e.byteLength),a=c===-1?t.defaultHeapSize:c,s=n._free,o=r(a);try{const f=n._ZSTD_decompress,d=f(o,a,i,e.byteLength);if(ye(d))throw new Error(`Failed to compress with code ${d}`);const u=new Uint8Array(n.HEAPU8.buffer,o,d).slice();return s(o,a),s(i,e.byteLength),u}catch(f){throw s(o,a),s(i,e.byteLength),f}};var Se=function(e,t,r,i){function c(a){return a instanceof r?a:new r(function(s){s(a)})}return new(r||(r=Promise))(function(a,s){function o(u){try{d(i.next(u))}catch(p){s(p)}}function f(u){try{d(i.throw(u))}catch(p){s(p)}}function d(u){u.done?a(u.value):c(u.value).then(o,f)}d((i=i.apply(e,t||[])).next())})};const xe=e=>Se(void 0,void 0,void 0,function*(){const t=new URL(""+new URL("zstd-CV7N7xSg.wasm",self.location.href).href,self.location.href).href;n.init(t),yield ve()}),Re=200,Te=100,O=20;let F=null,H=Promise.resolve(),j=null,w=null;const De=async e=>{const t=[];let r=Date.now();postMessage({type:"search-start",query:e.raw});for(let i=0;i<w.length;i++){if(i%Te===0){const a=Date.now();if(a-r>Re)if(r=a,await new Promise(o=>setTimeout(o,0)),e==F)t.length&&(postMessage({type:"search",items:t}),t.length=0);else{postMessage({type:"search-cancel"});return}}const c=be(e,w[i]);c&&t.push(c)}postMessage({type:"search-done",items:t})},be=(e,t)=>{const r=e.match(t[3]);if(!r)return;const i=t[3].slice(Math.max(0,r[0]-O),r[1]+O);return{gist_id:t[0],filename:t[1],created_at:t[2],body:i.split(e.highlighter)}},Ee=e=>e.replace(/[()[\]{}.?*+$^|\\]/g,"\\$1"),Ae=e=>{if(e.trim())if(e.startsWith("/")&&e.endsWith("/")){const t=e.slice(1,-1),r=new RegExp(`(${t})`,"i");return{match:c=>{const a=c.match(r);return a?[a.index,a.index+a[0].length]:null},highlighter:r,raw:e}}else{const t=e.split(/\s+/),r=t.map(s=>s.toLowerCase()),i=s=>{let o=1/0,f=0;const d=s.toLowerCase();for(const u of r){const p=d.indexOf(u);if(p<0)return null;p<o&&(o=p,f=u.length)}return[o,o+f]},c=t.map(Ee).join("|"),a=new RegExp(`(${c})`,"i");return{match:i,highlighter:a,raw:e}}else return},Ze=async e=>{w||await j;const t=Ae(e);F=t,await H,t?H=De(t):postMessage({type:"clear"})},Ce=async e=>{postMessage({type:"init"});const t=await fetch(e).then(i=>i.arrayBuffer());if(new URL(e).pathname.split(".").at(-1)==="zst"){await xe();const i=new TextDecoder().decode(we(new Uint8Array(t)));w=JSON.parse(i)}else{const i=new TextDecoder().decode(t);w=JSON.parse(i)}postMessage({type:"ready"})};addEventListener("message",async e=>{e.data.load?j=await Ce(e.data.load).catch(t=>{throw postMessage({type:"error",error:`Failed to load file: ${e.data.load}`}),t}):e.data.query!=null&&Ze(e.data.query)})})();
